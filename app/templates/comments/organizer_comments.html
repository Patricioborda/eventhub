{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
  <h1 class="mb-4">Comentarios en tus eventos</h1>

  {% if comentarios %}
    {% for c in comentarios %}
      <div class="card mb-3">
        <div class="card-body">
          <h5 class="card-title">{{ c.title }}</h5>
          <p class="mb-1"><strong>Evento:</strong>
            <a href="{% url 'event_detail' c.event.id %}">{{ c.event.title }}</a>
          </p>
          <p class="mb-1"><strong>Usuario:</strong> {{ c.user.username }}</p>
          <p class="mb-1">{{ c.content }}</p>
          <small class="text-muted">{{ c.created_at|date:"d/m/Y H:i" }}</small>

          <div class="mt-2">
            {# Solo autor o organizador del evento puede eliminar #}
            {% if request.user == c.user or request.user == c.event.organizer %}
              <form action="{% url 'comment_delete' c.pk %}" method="post" class="d-inline">
                {% csrf_token %}
                <button class="btn btn-sm btn-outline-danger" type="submit">
                  Eliminar
                </button>
              </form>
            {% endif %}
          </div>
        </div>
      </div>
    {% endfor %}
  {% else %}
    <p>No hay comentarios en tus eventos.</p>
  {% endif %}
</div>
{% endblock %}
